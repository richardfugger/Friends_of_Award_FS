@page "/"
@rendermode InteractiveServer
@using Blazor_WithAuth_ForSWP5
@using Microsoft.AspNetCore.Components.Authorization
@inject MyCustomAuthStateProvider? MyAuthStateProvider
@inject NavigationManager MyNavMgr

<PageTitle>Home</PageTitle>

<h1>Hello, world!</h1>

<AuthorizeView>
    <Authorized>
        @{
            // ja, man kann hier direkt C#-Code einfügen
            string name = "unknown";
            if (context.User.Identity != null)
                name = $"{context.User.Identity.Name}";
        }
        <h3>Willkommen, @name</h3>

        <NavLink href="/Admin">Zur Admin-Page</NavLink> <br />
        <button @onclick="Btn_Logout">Logout</button>
    </Authorized>

    <NotAuthorized>
        <h3 style="color: red">Sie sind nicht eingeloggt.</h3>
        <button @onclick="Btn_Login">Login</button>
    </NotAuthorized>
</AuthorizeView>





@code {
    void Btn_Login()
    {
        MyNavMgr.NavigateTo("/Login");
    }

    void Btn_Logout()
    {
        if (MyAuthStateProvider != null)
            MyAuthStateProvider.Logout();
        else
            Console.WriteLine("Fatal Error: AuthProvider == null!!");
    }
}
